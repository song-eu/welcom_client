{
"--- 6. monthly children rare disease count by location\r\nWITH condition_group AS (\r\nSELECT  lsp.SIDO_ADDR ,ROUND( (MONTHS_BETWEEN(DGNS_REG_DT, PT_BRDY_DT) \/ 12), 1) age,  lsp.PT_BRDY_DT, LSP.SEX_TP_CD\r\n, dg.DGNS_ID , dg.MED_DEPT_CD , dg.DGNS_REG_DT , MED_DEPT_NM, DGNS_REG_SEQ , dg.PT_NO , dg.PACT_ID , CLDG_VOC_ID , CLDG_NM , ICD10_CD , CD_ENG_NM, dg.DGNS_STR_DT \r\nFROM XCDW.FT_STM_DGNS dg\r\n\tLEFT JOIN XCDW.LT_STM_PT lsp\r\n\tON dg.PT_NO  = lsp.PT_NO \r\n\tWHERE DGNS_REG_DT BETWEEN TO_date('2004-10-14','yyyy-mm-dd') AND TO_date('2021-09-30','yyyy-mm-dd')\r\n\tAND ICD10_CD IN ('Q998', 'Q992', 'Q982', 'Q981', 'Q980', 'Q964', 'Q963', 'Q962', 'Q961', 'Q960', 'Q935', 'Q934', 'Q933', 'Q932', 'Q928', 'Q923', 'Q922', 'Q917', 'Q916', 'Q915', 'Q914', 'Q912', 'Q911', 'Q910', 'Q909', \r\n\t\t\t'Q902', 'Q901', 'Q900', 'Q878', 'Q875', 'Q874', 'Q873', 'Q872', 'Q871', 'Q870', 'Q860', 'Q858', 'Q851', 'Q850', 'Q828', 'Q824', 'Q823', 'Q820', 'Q812', 'Q811', 'Q810', 'Q804', 'Q803', 'Q802', 'Q801', 'Q799', 'Q798', 'Q796', \r\n\t\t\t'Q795', 'Q794', 'Q793', 'Q792', 'Q791', 'Q790', 'Q789', 'Q786', 'Q785', 'Q784', 'Q783', 'Q782', 'Q781', 'Q780', 'Q779', 'Q778', 'Q777', 'Q776', 'Q775', 'Q774', 'Q773', 'Q772', 'Q771', 'Q770', 'Q761', 'Q754', 'Q751', 'Q750', \r\n\t\t\t'Q748', 'Q743', 'Q740', 'Q641', 'Q619', 'Q611', 'Q447', 'Q446', 'Q442', 'Q438', 'Q383', 'Q282', 'Q266', 'Q265', 'Q264', 'Q263', 'Q262', 'Q261', 'Q260', 'Q255', 'Q253', 'Q252', 'Q251', 'Q246', 'Q245', 'Q244', 'Q239', 'Q238', \r\n\t\t\t'Q234', 'Q233', 'Q232', 'Q231', 'Q230', 'Q226', 'Q225', 'Q224', 'Q220', 'Q218', 'Q214', 'Q213', 'Q212', 'Q205', 'Q204', 'Q203', 'Q202', 'Q201', 'Q200', 'Q172', 'Q142', 'Q141', 'Q112', 'Q070', 'Q062', 'Q059', 'Q058', 'Q057', \r\n\t\t\t'Q056', 'Q055', 'Q054', 'Q053', 'Q052', 'Q051', 'Q050', 'Q046', 'Q043', 'Q042', 'Q031', 'P354', 'P350', 'N251', 'N047', 'N046', 'N045', 'N044', 'N043', 'N042', 'N041', 'N040', 'M941', 'M931', 'M922', 'M889', 'M888', 'M880', \r\n\t\t\t'M611', 'M356', 'M355', 'M354', 'M353', 'M352', 'M351', 'M350', 'M348', 'M341', 'M340', 'M332', 'M331', 'M330', 'M321', 'M317', 'M314', 'M313', 'M311', 'M310', 'M302', 'M301', 'M300', 'M083', 'M082', 'M081', 'M080', 'M061', \r\n\t\t\t'L123', 'L121', 'L120', 'L102', 'L100', 'K830', 'K754', 'K743', 'K508', 'K501', 'K500', 'K0051', 'J841', 'J840', 'J398', 'I820', 'I780', 'I731', 'I675', 'I4982', 'I472', 'I4280', 'I424', 'I423', 'I4220', 'I421', 'I420', 'I278', \r\n\t\t\t'I270', 'H518', 'H498', 'H494', 'H3559', 'H3558', 'H3552', 'H3551', 'H350', 'H312', 'H186', 'H185', 'H163', 'G950', 'G934', 'G906', 'G905', 'G731', 'G724', 'G723', 'G719', 'G713', 'G712', 'G711', 'G710', 'G702', 'G700', 'G618', \r\n\t\t\t'G610', 'G600', 'G518', 'G512', 'G474', 'G4731', 'G419', 'G418', 'G412', 'G411', 'G410', 'G404', 'G360', 'G35', 'G3188', 'G3181', 'G258', 'G248', 'G238', 'G231', 'G230', 'G129', 'G128', 'G122', 'G121', 'G120', 'G119', 'G118', \r\n\t\t\t'G114', 'G113', 'G112', 'G111', 'G110', 'G10', 'G048', 'F842', 'F803', 'F011', 'E881', 'E880', 'E854', 'E852', 'E851', 'E850', 'E841', 'E840', 'E833', 'E832', 'E831', 'E830', 'E802', 'E791', 'E771', 'E770', 'E762', 'E761', \r\n\t\t\t'E760', 'E755', 'E754', 'E752', 'E751', 'E750', 'E748', 'E744', 'E742', 'E740', 'E730', 'E728', 'E725', 'E724', 'E723', 'E722', 'E721', 'E720', 'E713', 'E711', 'E710', 'E708', 'E703', 'E702', 'E701', 'E700', 'E550', 'E348', \r\n\t\t\t'E274', 'E272', 'E271', 'E268', 'E259', 'E250', 'E243', 'E241', 'E240', 'E230', 'E220', 'E201', 'E1610', 'D891', 'D868', 'D863', 'D862', 'D861', 'D860', 'D841', 'D840', 'D832', 'D831', 'D830', 'D824', 'D823', 'D822', 'D821', \r\n\t\t\t'D820', 'D819', 'D818', 'D817', 'D816', 'D815', 'D814', 'D813', 'D812', 'D811', 'D810', 'D808', 'D806', 'D805', 'D804', 'D803', 'D802', 'D801', 'D800', 'D763', 'D761', 'D71', 'D70', 'D694', 'D693', 'D691', 'D686', 'D685', \r\n\t\t\t'D682', 'D681', 'D680', 'D67', 'D66', 'D644', 'D619', 'D613', 'D610', 'D600', 'D595', 'D593', 'D564', 'D563', 'D562', 'D561', 'D560', 'D552', 'D550', 'D126', 'A810', 'A319')\r\n\tAND dg.HSP_TP_CD = '2')\r\n\tSELECT \r\n\tTO_CHAR(SRGR_STR_DTM, 'YYYY') dt\r\n\t, COUNT(*) ROWCNT\r\n\t, COUNT(DISTINCT PT_NO) PCNT\r\n\t, COUNT(DISTINCT PACT_ID) VISITCNT \r\n\tFROM FT_STM_SRGR FSS\r\n\tWHERE EXISTS (SELECT 1\r\n\t\t\t\tFROM condition_group CG \r\n\t\t\t\tWHERE FSS.PT_NO = CG.PT_NO\r\n\t\t\t\tAND FSS.CLDG_VOC_ID = CG.CLDG_VOC_ID\r\n\t\t\t\tAND FSS.SRGR_STR_DTM BETWEEN CG.DGNS_STR_DT AND CG.DGNS_REG_DT  )\r\n\tGROUP BY ROLLUP (TO_CHAR(SRGR_STR_DTM, 'YYYY'))\r\n\tORDER BY 1\r\n\t": [
	{
		"DT" : "2004",
		"ROWCNT" : 109,
		"PCNT" : 102,
		"VISITCNT" : 103
	},
	{
		"DT" : "2005",
		"ROWCNT" : 586,
		"PCNT" : 490,
		"VISITCNT" : 536
	},
	{
		"DT" : "2006",
		"ROWCNT" : 673,
		"PCNT" : 533,
		"VISITCNT" : 595
	},
	{
		"DT" : "2007",
		"ROWCNT" : 726,
		"PCNT" : 600,
		"VISITCNT" : 674
	},
	{
		"DT" : "2008",
		"ROWCNT" : 799,
		"PCNT" : 640,
		"VISITCNT" : 732
	},
	{
		"DT" : "2009",
		"ROWCNT" : 794,
		"PCNT" : 645,
		"VISITCNT" : 736
	},
	{
		"DT" : "2010",
		"ROWCNT" : 816,
		"PCNT" : 667,
		"VISITCNT" : 769
	},
	{
		"DT" : "2011",
		"ROWCNT" : 885,
		"PCNT" : 709,
		"VISITCNT" : 831
	},
	{
		"DT" : "2012",
		"ROWCNT" : 943,
		"PCNT" : 731,
		"VISITCNT" : 880
	},
	{
		"DT" : "2013",
		"ROWCNT" : 898,
		"PCNT" : 708,
		"VISITCNT" : 844
	},
	{
		"DT" : "2014",
		"ROWCNT" : 1027,
		"PCNT" : 809,
		"VISITCNT" : 935
	},
	{
		"DT" : "2015",
		"ROWCNT" : 982,
		"PCNT" : 764,
		"VISITCNT" : 908
	},
	{
		"DT" : "2016",
		"ROWCNT" : 1070,
		"PCNT" : 817,
		"VISITCNT" : 971
	},
	{
		"DT" : "2017",
		"ROWCNT" : 924,
		"PCNT" : 716,
		"VISITCNT" : 845
	},
	{
		"DT" : "2018",
		"ROWCNT" : 1040,
		"PCNT" : 827,
		"VISITCNT" : 981
	},
	{
		"DT" : "2019",
		"ROWCNT" : 1115,
		"PCNT" : 882,
		"VISITCNT" : 1048
	},
	{
		"DT" : "2020",
		"ROWCNT" : 1097,
		"PCNT" : 857,
		"VISITCNT" : 999
	},
	{
		"DT" : "2021",
		"ROWCNT" : 729,
		"PCNT" : 605,
		"VISITCNT" : 692
	},
	{
		"DT" : null,
		"ROWCNT" : 15213,
		"PCNT" : 8320,
		"VISITCNT" : 14035
	}
]}
